<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Chi tiáº¿t Tour - Iuborn Travel</title>
  <link rel="stylesheet" href="libs/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="style.css">
  <style>
    .card-img-top {
      object-fit: cover;
      height: 300px;
    }
    .card-body {
      padding: 2rem;
    }
    .card-title {
      font-size: 1.5rem;
    }
    .card-text {
      font-size: 1.125rem;
    }
    .btn {
      margin-top: 1rem;
    }
    .tour-detail-info {
      margin-top: 2rem;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="bg-light shadow-sm p-3 mb-4">
    <div class="container d-flex justify-content-between align-items-center flex-wrap">
        <h1 class="h3 text-primary mb-2 mb-md-0" id="titleheader">ğŸŒ Iuborn Travel</h1>
        <nav class="d-flex align-items-center flex-wrap">
            <ul class="nav" id="mainNav">
                <li class="nav-item"><a class="nav-link" href="index.html">Trang chá»§</a></li>
                <li class="nav-item"><a class="nav-link" href="tours.html">Tour</a></li>
                <li class="nav-item"><a class="nav-link" href="news.html">Tin tá»©c</a></li>
                <li class="nav-item"><a class="nav-link" href="about.html">Giá»›i thiá»‡u</a></li>
                <li class="nav-item" id="registerNav"><a class="nav-link" href="register.html">ÄÄƒng kÃ½</a></li>
            </ul>
            <div id="userGreeting" class="ms-3 d-none d-flex align-items-center flex-wrap gap-2">
                <strong id="usernameDisplay" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 100px;"></strong>
                <a href="payment.html" id="cartLink" class="text-decoration-none" style="margin-left: 10px;">
                    Giá» hÃ ng (<span id="cartItemCount">0</span>)
                </a>
                <span id="separator" class="d-none">|</span>
                <a href="#" id="logoutBtn" class="text-danger text-decoration-none" style="white-space: nowrap; margin-left: 10px;">ÄÄƒng xuáº¥t</a>
            </div>
        </nav>
    </div>
</header>

  <!-- Tour Detail Section -->
  <section class="container tour-detail-info">
    <div class="row">
      <div class="col-md-6">
        <img src="" id="tourImage" class="card-img-top" alt="Tour Image">
      </div>
      <div class="col-md-6">
        <h2 id="tourName" class="card-title">TÃªn Tour</h2>
        <p id="tourDescription" class="card-text">MÃ´ táº£ tour</p>
        <p><strong>GiÃ¡:</strong> <span id="tourPrice">GiÃ¡</span></p>
        <p><strong>NgÃ y khá»Ÿi hÃ nh:</strong> <span id="tourDeparture">NgÃ y</span></p>
        <p><strong>Äiá»ƒm Ä‘áº¿n:</strong> <span id="tourDestination">Äá»‹a Ä‘iá»ƒm</span></p>
        <a href="#" id="bookNowBtn" class="btn btn-primary">Äáº·t tour ngay</a>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="bg-dark text-light p-4 mt-auto">
    <div class="container text-center">
      <p>Â© 2025 Iuborn Travel.</p>
      <p><a href="sitemap.html" class="text-light">Sitemap</a> | <a href="about.html" class="text-light">LiÃªn há»‡</a></p>
    </div>
  </footer>

  <!-- Scripts -->
  <script src="libs/jquery/jquery.min.js"></script>
  <script src="libs/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="libs/jquery/updateHeaderAuth.js"></script>
  <script>
    $(document).ready(function () {
      // Láº¥y ID tour tá»« URL
      const urlParams = new URLSearchParams(window.location.search);
      const tourId = urlParams.get("id");
  
      // Danh sÃ¡ch tour máº«u (cÃ³ thá»ƒ load tá»« server hoáº·c file JSON náº¿u cáº§n)
      const tours = [
        {
          id: "1",
          name: "KhÃ¡m phÃ¡ Háº¡ Long",
          description: "Chuyáº¿n du ngoáº¡n 2 ngÃ y 1 Ä‘Ãªm Ä‘áº¿n vá»‹nh Háº¡ Long tuyá»‡t Ä‘áº¹p.",
          image: "../img/vinhHaLongQuangNinh-1651912066-8789-1651932294.webp",
          price: 2500000,
          departure: "01/05/2025",
          destination: "Vá»‹nh Háº¡ Long"
        },
        {
          id: "2",
          name: "HÃ nh trÃ¬nh Sapa",
          description: "KhÃ¡m phÃ¡ Sapa má» sÆ°Æ¡ng, ruá»™ng báº­c thang vÃ  vÄƒn hÃ³a vÃ¹ng cao.",
          image: "../img/1-cam-nang-du-lich-sapa.png",
          price: 3200000,
          departure: "15/05/2025",
          destination: "Sapa"
        },
        {
          id: "3",
          name: "ÄÃ  Náºµng â€“ Há»™i An",
          description: "Tráº£i nghiá»‡m phá»‘ cá»• Há»™i An vÃ  thÃ nh phá»‘ biá»ƒn ÄÃ  Náºµng hiá»‡n Ä‘áº¡i.",
          image: "../img/di-da-nang-hoi-an-nen-di-may-ngay-3-0926.webp",
          price: 3900000,
          departure: "20/05/2025",
          destination: "ÄÃ  Náºµng, Há»™i An"
        }
      ];
  
      // Hiá»ƒn thá»‹ thÃ´ng tin tour náº¿u tÃ¬m tháº¥y
      const tour = tours.find(t => t.id === tourId);
      if (tour) {
        $('#tourImage').attr('src', tour.image);
        $('#tourName').text(tour.name);
        $('#tourDescription').text(tour.description);
        $('#tourPrice').text(tour.price.toLocaleString('vi-VN') + 'Ä‘'); // Äá»‹nh dáº¡ng khi hiá»ƒn thá»‹
        $('#tourDeparture').text(tour.departure);
        $('#tourDestination').text(tour.destination);
    } else {
        $('.tour-detail-info').html('<h3>Tour khÃ´ng tá»“n táº¡i.</h3>');
      }
  
      // Xá»­ lÃ½ khi báº¥m nÃºt "Äáº·t tour ngay"
      $('#bookNowBtn').on('click', function (e) {
        e.preventDefault();
      
        const isLoggedIn = localStorage.getItem("loggedIn");
      
        if (isLoggedIn === "true") {
          // Láº¥y thÃ´ng tin tour Ä‘ang xem
          const selectedTour = tours.find(t => t.id === tourId);
          if (!selectedTour) return;
      
          // Láº¥y giá» hÃ ng hiá»‡n táº¡i tá»« localStorage
          let cart = JSON.parse(localStorage.getItem("cart")) || [];
      
          // Kiá»ƒm tra náº¿u tour chÆ°a cÃ³ trong giá» thÃ¬ thÃªm vÃ o
          const isAlreadyInCart = cart.some(t => t.id === selectedTour.id);
          if (!isAlreadyInCart) {
            cart.push(selectedTour);
            localStorage.setItem("cart", JSON.stringify(cart));
          }
      
          // Chuyá»ƒn Ä‘áº¿n trang thanh toÃ¡n kÃ¨m theo tour id
          window.location.href = `payment.html?id=${tourId}`;
        } else {
          // Náº¿u chÆ°a Ä‘Äƒng nháº­p thÃ¬ chuyá»ƒn sang trang Ä‘Äƒng kÃ½
          window.location.href = "register.html";
        }
      });
    });
  </script>  
</body>
</html>
